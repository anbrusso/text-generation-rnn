<html>
    {% load static %}
    <head>
            <title>RNN based text generation</title>
            <!---Boostrap includes-->
            <!-- CSS -->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

            <!-- jQuery and JS bundle w/ Popper.js -->
            <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>            <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <div class="container">
            <h2 class="mt-5">Text Generation</h2>
            <form id="text-generator" method="post">
                {% csrf_token %}
                <div class="form-group">
                    <label for = "seed-text">Enter seed text to be used for text generation:</label>
                    {{form.seed_text}}
                </div>
                <fieldset>
                    <legend>Text Generation Settings</legend>
                    <div class="form-group">
                        <label for = "output-length">Output Text Length</label>
                        {{form.output_length}}
                    </div>
                    <div class="form-group">
                        <label for="temperature">Text Temperature&mdash; Modifies the randomness injected into the text. Higher values result in more random text.</label>
                        {{form.temperature}}
                    </div>
                    <fieldset class="form-group">
                        <legend>Which model would you like to utilize</legend>
                        {% for choice in form.model_type %}
                            <div class="form-check">
                                {{ choice }}
                            </div>
                        {% endfor %}
                    </fieldset>
                </fieldset>
                <div class="text-center">
                    <input type="submit" value = "Generate Text" class="btn btn-primary"/>
                </div>
            </form>
            <div class="border pb-5">
                <div  id="loader" class="d-none w-50 mx-auto">
                    <img src="{% static 'loading.gif' %}" class="mx-auto w-25 d-block"/>
                </div>
                <div id = "output-text"> Output text loads here</div>
            </div>
            <script>
                var request;
                $("#text-generator").submit(function(e){
                    e.preventDefault();
                    if(request){
                        request.abort();
                    }
                    request = $.post({
                        url:"",
                        data: $(this).serialize(),
                        success: function(response){
                            if(response){
                                response = JSON.parse(response)
                                $("#output-text").removeClass("d-none").html(response["output_text"]);
                                $("#loader").addClass("d-none");
                            }
                        },
                        beforeSend: function(){
                            $("#output-text").addClass("d-none");
                            $("#loader").removeClass("d-none");
                        }
                    });
                })
            </script>
        </div>
    </body>
</html>